================================================================================
                EXPLICAÃ‡ÃƒO DETALHADA DO CÃ“DIGO - REDE MAIS SOCIAL
                        Guia para Entender e Explicar
================================================================================

Este documento explica linha por linha como o cÃ³digo funciona, para vocÃª
conseguir explicar no vÃ­deo com seguranÃ§a.

================================================================================
1. WEBSERVER.JAVA - O SERVIDOR HTTP
================================================================================

PROPÃ“SITO:
----------
Ã‰ o "coraÃ§Ã£o" do sistema. Recebe requisiÃ§Ãµes HTTP do navegador e responde.
Funciona como um mini-servidor web feito em Java.

COMO FUNCIONA:
--------------

PARTE 1: InicializaÃ§Ã£o do Servidor
-----------------------------------
```java
public static void main(String[] args) throws Exception {
    HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);
```
â†’ Cria um servidor HTTP que escuta na porta 8080
â†’ InetSocketAddress(8080) = "escute requisiÃ§Ãµes vindas de localhost:8080"
â†’ O "0" significa: use o nÃºmero padrÃ£o de conexÃµes simultÃ¢neas

```java
    server.createContext("/", new StaticFileHandler());
```
â†’ "Quando alguÃ©m acessar qualquer URL (comeÃ§ando com /), use StaticFileHandler"
â†’ StaticFileHandler serve arquivos HTML, CSS, JS

```java
    server.createContext("/api/solicitar-afiliacao", new SolicitarAfiliacaoHandler());
```
â†’ "Quando alguÃ©m acessar /api/solicitar-afiliacao, use SolicitarAfiliacaoHandler"
â†’ Esse Ã© o endpoint que recebe o cadastro do voluntÃ¡rio

```java
    server.setExecutor(null);
    server.start();
```
â†’ setExecutor(null) = use o executor padrÃ£o (gerencia threads)
â†’ start() = inicia o servidor
â†’ Agora ele fica "ouvindo" e esperando requisiÃ§Ãµes


PARTE 2: StaticFileHandler - Serve Arquivos EstÃ¡ticos
------------------------------------------------------
```java
static class StaticFileHandler implements HttpHandler {
    public void handle(HttpExchange exchange) throws IOException {
```
â†’ Essa classe implementa HttpHandler = sabe receber e responder requisiÃ§Ãµes
â†’ handle() Ã© chamado toda vez que alguÃ©m acessa uma URL

```java
        String path = exchange.getRequestURI().getPath();
        if (path.equals("/")) {
            path = "/index.html";
        }
```
â†’ Pega o caminho da URL (ex: "/index.html")
â†’ Se for sÃ³ "/" (raiz), redireciona pra "/index.html"

```java
        File file = new File("web" + path);
        if (file.exists() && !file.isDirectory()) {
```
â†’ Tenta achar o arquivo na pasta "web"
â†’ Exemplo: se pediu "/index.html", procura "web/index.html"
â†’ Verifica se existe e se nÃ£o Ã© uma pasta

```java
            byte[] bytes = Files.readAllBytes(file.toPath());
            exchange.sendResponseHeaders(200, bytes.length);
            OutputStream os = exchange.getResponseBody();
            os.write(bytes);
            os.close();
```
â†’ LÃª o conteÃºdo do arquivo todo em bytes
â†’ sendResponseHeaders(200, ...) = "200 OK, aqui estÃ¡ o arquivo"
â†’ Escreve os bytes na resposta (envia pro navegador)
â†’ Fecha a conexÃ£o

```java
        } else {
            String response = "404 - Arquivo nÃ£o encontrado";
            exchange.sendResponseHeaders(404, response.length());
            // ...envia mensagem de erro
        }
```
â†’ Se arquivo nÃ£o existe, retorna "404 Not Found"


PARTE 3: SolicitarAfiliacaoHandler - Processa Cadastro
-------------------------------------------------------
```java
static class SolicitarAfiliacaoHandler implements HttpHandler {
    public void handle(HttpExchange exchange) throws IOException {
```
â†’ Handler especÃ­fico para processar cadastros

```java
        if (!"POST".equals(exchange.getRequestMethod())) {
            exchange.sendResponseHeaders(405, -1);
            return;
        }
```
â†’ Verifica se Ã© uma requisiÃ§Ã£o POST (envio de dados)
â†’ Se nÃ£o for POST, retorna erro 405 "MÃ©todo nÃ£o permitido"

```java
        InputStreamReader isr = new InputStreamReader(exchange.getRequestBody(), "utf-8");
        BufferedReader br = new BufferedReader(isr);
        StringBuilder body = new StringBuilder();
        String line;
        while ((line = br.readLine()) != null) {
            body.append(line);
        }
```
â†’ LÃª o corpo da requisiÃ§Ã£o (que vem em JSON)
â†’ Vai lendo linha por linha e juntando tudo numa String

```java
        String jsonString = body.toString();
        System.out.println("ðŸ“¨ JSON recebido: " + jsonString);
```
â†’ Imprime no console o JSON recebido (pra debug)

```java
        // Parse manual do JSON
        Candidato candidato = new Candidato();
        candidato.setNome(extrairValor(jsonString, "nome"));
        candidato.setEmail(extrairValor(jsonString, "email"));
        // ... extrai todos os campos
```
â†’ Como nÃ£o estamos usando biblioteca JSON, extraÃ­mos "na mÃ£o"
â†’ extrairValor() Ã© um mÃ©todo que busca "email":"valor" no JSON

```java
        String dataNascimentoStr = extrairValor(jsonString, "dataNascimento");
        if (dataNascimentoStr != null && !dataNascimentoStr.equals("null")) {
            candidato.setDataNascimento(LocalDate.parse(dataNascimentoStr));
        }
```
â†’ Data vem como String "1990-01-01"
â†’ LocalDate.parse() converte pra objeto LocalDate do Java

```java
        AfiliacaoController controller = new AfiliacaoController();
        Candidato candidatoCriado = controller.criarCandidato(candidato);
```
â†’ Cria uma instÃ¢ncia do Controller
â†’ Chama o mÃ©todo que vai validar, salvar no banco e gerar token

```java
        if (candidatoCriado != null) {
            String jsonResponse = "{\"sucesso\":true,\"mensagem\":\"Cadastro realizado!\",\"token\":\"" + 
                                candidatoCriado.getToken() + "\"}";
            // ...envia resposta positiva
        } else {
            String jsonResponse = "{\"sucesso\":false,\"mensagem\":\"Erro ao criar candidato\"}";
            // ...envia resposta negativa
        }
```
â†’ Monta um JSON de resposta
â†’ Se deu certo, retorna sucesso e o token
â†’ Se deu errado, retorna erro


RESUMO WEBSERVER:
-----------------
1. Servidor escuta na porta 8080
2. Quando alguÃ©m acessa uma URL:
   - Se for arquivo (HTML/CSS), StaticFileHandler serve o arquivo
   - Se for /api/solicitar-afiliacao, SolicitarAfiliacaoHandler processa
3. Handler lÃª o JSON, extrai os dados, chama o Controller
4. Retorna resposta em JSON pro navegador

================================================================================
2. AFILIACAOCONTROLLER.JAVA - LÃ“GICA DE NEGÃ“CIO
================================================================================

PROPÃ“SITO:
----------
Concentra toda a lÃ³gica do processo de afiliaÃ§Ã£o. Ã‰ o "cÃ©rebro" do sistema.

COMO FUNCIONA:
--------------

PARTE 1: Construtor
-------------------
```java
public AfiliacaoController() {
    this.candidatoDAO = new CandidatoDAO();
    this.afiliacaoDAO = new AfiliacaoDAO();
}
```
â†’ Quando cria um Controller, ele jÃ¡ cria os DAOs que vai usar
â†’ DAOs sÃ£o as classes que conversam com o banco de dados

PARTE 2: criarCandidato() - MÃ©todo Principal
---------------------------------------------
```java
public Candidato criarCandidato(Candidato candidato) {
```
â†’ Recebe um objeto Candidato com todos os dados preenchidos

```java
    if (!Validador.validarEmail(candidato.getEmail())) {
        System.out.println("âŒ ERRO: Email invÃ¡lido!");
        return null;
    }
```
â†’ Valida o email usando a classe Validador
â†’ Se email for invÃ¡lido, para tudo e retorna null (erro)

```java
    String cpf = candidato.getCpf();
    String cnpj = candidato.getCnpj();
    
    if ((cpf == null || cpf.equals("null") || cpf.trim().isEmpty()) && 
        (cnpj == null || cnpj.equals("null") || cnpj.trim().isEmpty())) {
        System.out.println("âŒ ERRO: CPF ou CNPJ deve ser informado!");
        return null;
    }
```
â†’ Verifica se tem CPF OU CNPJ preenchido
â†’ Tem que ter pelo menos um dos dois
â†’ Verifica se nÃ£o Ã© null, "null" (string), ou vazio

```java
    if (cpf != null && !cpf.equals("null") && !cpf.trim().isEmpty()) {
        if (!Validador.validarCPF(cpf)) {
            System.out.println("âŒ ERRO: CPF invÃ¡lido!");
            return null;
        }
    }
```
â†’ Se tem CPF, valida ele
â†’ CPF tem que ter 11 dÃ­gitos

```java
    if (cnpj != null && !cnpj.equals("null") && !cnpj.trim().isEmpty()) {
        if (!Validador.validarCNPJ(cnpj)) {
            System.out.println("âŒ ERRO: CNPJ invÃ¡lido!");
            return null;
        }
    }
```
â†’ Se tem CNPJ, valida ele
â†’ CNPJ tem que ter 14 dÃ­gitos

```java
    candidato.setSituacao("PENDENTE");
    candidato.setAceiteTermo(true);
```
â†’ Define situaÃ§Ã£o inicial como "PENDENTE" (aguardando aprovaÃ§Ã£o)
â†’ Marca que aceitou o termo de compromisso

```java
    boolean inserido = candidatoDAO.inserir(candidato);
```
â†’ Chama o DAO pra inserir no banco
â†’ Retorna true se deu certo, false se deu errado

```java
    if (!inserido) {
        System.out.println("âŒ ERRO: NÃ£o foi possÃ­vel inserir candidato!");
        return null;
    }
```
â†’ Se nÃ£o conseguiu inserir, para tudo

```java
    String token = gerarToken(candidato.getEmail());
    System.out.println("ðŸŽ« Token gerado: " + token);
```
â†’ Gera um token Ãºnico de 32 caracteres
â†’ Usa o email como base pra gerar

```java
    Afiliacao afiliacao = new Afiliacao();
    afiliacao.setIdCandidato(candidato.getIdCandidato());
    afiliacao.setToken(token);
    afiliacao.setDataSolicitacao(new Date());
    afiliacao.setStatus("PENDENTE");
```
â†’ Cria um objeto Afiliacao
â†’ Liga ao candidato pelo ID
â†’ Guarda o token e a data atual
â†’ Status inicial: PENDENTE

```java
    afiliacaoDAO.inserir(afiliacao);
```
â†’ Salva a afiliaÃ§Ã£o no banco

```java
    EmailService.enviarEmailConfirmacao(candidato.getEmail(), candidato.getNome(), token);
```
â†’ Envia email pro candidato com o token

```java
    candidato.setToken(token);
    return candidato;
```
â†’ Coloca o token no objeto candidato pra retornar
â†’ Retorna o candidato com todos os dados + token


PARTE 3: gerarToken() - GeraÃ§Ã£o do Token
-----------------------------------------
```java
private String gerarToken(String email) {
    try {
        String input = email + System.currentTimeMillis();
```
â†’ Junta o email com o timestamp atual (milissegundos)
â†’ Exemplo: "joao@email.com1700000000000"
â†’ Isso garante que cada token Ã© Ãºnico

```java
        MessageDigest md = MessageDigest.getInstance("MD5");
        byte[] hash = md.digest(input.getBytes());
```
â†’ Usa algoritmo MD5 pra criar um hash
â†’ MD5 transforma qualquer texto em 32 caracteres hexadecimais

```java
        StringBuilder hexString = new StringBuilder();
        for (byte b : hash) {
            String hex = Integer.toHexString(0xff & b);
            if (hex.length() == 1) hexString.append('0');
            hexString.append(hex);
        }
        return hexString.toString();
```
â†’ Converte os bytes do hash pra formato hexadecimal (0-9, a-f)
â†’ Retorna string de 32 caracteres


PARTE 4: validarToken() - ValidaÃ§Ã£o do Token
---------------------------------------------
```java
public boolean validarToken(String token) {
    Afiliacao afiliacao = afiliacaoDAO.buscarPorToken(token);
    
    if (afiliacao == null) {
        System.out.println("âŒ Token nÃ£o encontrado!");
        return false;
    }
```
â†’ Busca no banco uma afiliaÃ§Ã£o com esse token
â†’ Se nÃ£o achar, token Ã© invÃ¡lido

```java
    if (!"PENDENTE".equals(afiliacao.getStatus())) {
        System.out.println("âŒ Token jÃ¡ foi validado ou expirado!");
        return false;
    }
```
â†’ Verifica se ainda estÃ¡ pendente
â†’ Se jÃ¡ foi usado (status diferente de PENDENTE), nÃ£o pode usar de novo

```java
    afiliacaoDAO.atualizarStatus(afiliacao.getIdAfiliacao(), "VALIDADO");
    System.out.println("âœ… Token validado com sucesso!");
    return true;
```
â†’ Atualiza o status pra "VALIDADO"
â†’ Retorna true (sucesso)


RESUMO AFILIACAOCONTROLLER:
---------------------------
1. Recebe dados do candidato
2. Valida email, CPF/CNPJ
3. Salva no banco via CandidatoDAO
4. Gera token Ãºnico (MD5 de email + timestamp)
5. Cria e salva registro de Afiliacao
6. Envia email com token
7. Retorna candidato criado com token

================================================================================
3. CANDIDATODAO.JAVA - ACESSO AO BANCO (CANDIDATOS)
================================================================================

PROPÃ“SITO:
----------
Faz todas as operaÃ§Ãµes no banco relacionadas Ã  tabela "candidato".
Ã‰ a Ãºnica classe que escreve SQL para candidatos.

COMO FUNCIONA:
--------------

PARTE 1: inserir() - Insere Novo Candidato
-------------------------------------------
```java
public boolean inserir(Candidato candidato) {
    String sql = "INSERT INTO candidato (nome, email, cpf, cnpj, sexo, " +
                 "data_nascimento, nacionalidade, endereco, telefone, " +
                 "perfil_voluntario, habilidades, areas_interesse, " +
                 "situacao, aceite_termo) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
```
â†’ String com o comando SQL de INSERT
â†’ Os "?" sÃ£o placeholders (serÃ£o substituÃ­dos pelos valores)
â†’ Usar "?" previne SQL Injection (ataque de seguranÃ§a)

```java
    try (Connection conn = DatabaseConnection.getConnection();
         PreparedStatement stmt = conn.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS)) {
```
â†’ Pega uma conexÃ£o com o banco
â†’ PreparedStatement = permite usar placeholders (?)
â†’ RETURN_GENERATED_KEYS = retorna o ID gerado automaticamente

```java
        stmt.setString(1, candidato.getNome());
        stmt.setString(2, candidato.getEmail());
        stmt.setString(3, candidato.getCpf());
        // ... preenche todos os 14 valores
```
â†’ Substitui cada "?" pelo valor correspondente
â†’ setString(1, ...) = substitui o 1Âº "?"
â†’ setString(2, ...) = substitui o 2Âº "?"
â†’ E assim por diante...

```java
        if (candidato.getDataNascimento() != null) {
            stmt.setDate(6, java.sql.Date.valueOf(candidato.getDataNascimento()));
        } else {
            stmt.setNull(6, java.sql.Types.DATE);
        }
```
â†’ Data precisa de tratamento especial
â†’ Converte LocalDate pra java.sql.Date
â†’ Se for null, insere NULL no banco

```java
        int rowsAffected = stmt.executeUpdate();
```
â†’ Executa o INSERT no banco
â†’ Retorna quantas linhas foram afetadas (deve ser 1)

```java
        if (rowsAffected > 0) {
            try (ResultSet rs = stmt.getGeneratedKeys()) {
                if (rs.next()) {
                    candidato.setIdCandidato(rs.getInt(1));
                }
            }
        }
```
â†’ Se inseriu com sucesso, pega o ID gerado
â†’ getGeneratedKeys() retorna o ID auto_increment
â†’ Coloca esse ID no objeto candidato

```java
        return rowsAffected > 0;
```
â†’ Retorna true se inseriu, false se nÃ£o inseriu


PARTE 2: buscarPorEmail() - Busca Candidato por Email
------------------------------------------------------
```java
public Candidato buscarPorEmail(String email) {
    String sql = "SELECT * FROM candidato WHERE email = ?";
```
â†’ SQL de SELECT com WHERE
â†’ Busca linha onde email Ã© igual ao parÃ¢metro

```java
    try (Connection conn = DatabaseConnection.getConnection();
         PreparedStatement stmt = conn.prepareStatement(sql)) {
        
        stmt.setString(1, email);
        ResultSet rs = stmt.executeQuery();
```
â†’ Prepara a query substituindo o "?" pelo email
â†’ executeQuery() = executa SELECT e retorna resultados

```java
        if (rs.next()) {
            Candidato candidato = new Candidato();
            candidato.setIdCandidato(rs.getInt("id_candidato"));
            candidato.setNome(rs.getString("nome"));
            candidato.setEmail(rs.getString("email"));
            // ... preenche todos os campos
```
â†’ rs.next() = avanÃ§a pra prÃ³xima linha (primeira, nesse caso)
â†’ Se achou, cria objeto Candidato
â†’ Preenche com dados do ResultSet
â†’ rs.getString("nome") = pega valor da coluna "nome"

```java
            return candidato;
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
    return null;
```
â†’ Se nÃ£o achou nada, retorna null
â†’ Se der erro, imprime e retorna null


RESUMO CANDIDATODAO:
--------------------
1. inserir(): Monta SQL INSERT, substitui valores, executa, retorna ID gerado
2. buscarPorEmail(): Monta SQL SELECT, executa, transforma resultado em objeto
3. Usa PreparedStatement pra evitar SQL Injection
4. try-with-resources fecha conexÃµes automaticamente

================================================================================
4. AFILIACAODAO.JAVA - ACESSO AO BANCO (AFILIAÃ‡Ã•ES)
================================================================================

PROPÃ“SITO:
----------
Faz operaÃ§Ãµes na tabela "afiliacao" (solicitaÃ§Ãµes de cadastro).

COMO FUNCIONA:
--------------

Similar ao CandidatoDAO, mas para tabela afiliacao:

```java
public boolean inserir(Afiliacao afiliacao) {
    String sql = "INSERT INTO afiliacao (id_candidato, token, data_solicitacao, status) " +
                 "VALUES (?, ?, ?, ?)";
```
â†’ Insere novo registro de afiliaÃ§Ã£o
â†’ Liga ao candidato pelo id_candidato

```java
public Afiliacao buscarPorToken(String token) {
    String sql = "SELECT * FROM afiliacao WHERE token = ?";
```
â†’ Busca afiliaÃ§Ã£o pelo token
â†’ Usado na validaÃ§Ã£o do email

```java
public boolean atualizarStatus(int idAfiliacao, String novoStatus) {
    String sql = "UPDATE afiliacao SET status = ? WHERE id_afiliacao = ?";
```
â†’ Atualiza o status (PENDENTE â†’ VALIDADO, por exemplo)

RESUMO AFILIACAODAO:
--------------------
Mesma lÃ³gica do CandidatoDAO, mas para afiliaÃ§Ãµes.

================================================================================
5. CANDIDATO.JAVA E AFILIACAO.JAVA - CLASSES DE MODELO
================================================================================

PROPÃ“SITO:
----------
Representam dados. SÃ£o como "caixinhas" que guardam informaÃ§Ãµes.

CANDIDATO.JAVA:
---------------
```java
public class Candidato {
    private int idCandidato;
    private String nome;
    private String email;
    // ... todos os atributos
```
â†’ Cada atributo representa uma coluna do banco

```java
    public String getNome() {
        return nome;
    }
    
    public void setNome(String nome) {
        this.nome = nome;
    }
```
â†’ Getters e Setters pra cada atributo
â†’ get = pegar valor
â†’ set = definir valor

AFILIACAO.JAVA:
---------------
Mesma ideia, mas pra afiliaÃ§Ã£o:
- idAfiliacao
- idCandidato (liga ao candidato)
- token
- dataSolicitacao
- status

RESUMO MODELS:
--------------
SÃ£o POJOs (Plain Old Java Objects) = objetos simples sÃ³ com dados.
NÃ£o tÃªm lÃ³gica, sÃ³ armazenam informaÃ§Ãµes.

================================================================================
6. DATABASECONNECTION.JAVA - CONEXÃƒO COM MYSQL
================================================================================

PROPÃ“SITO:
----------
Gerencia conexÃµes com o banco de dados.

COMO FUNCIONA:
--------------

```java
public class DatabaseConnection {
    private static final String URL = "jdbc:mysql://localhost:3306/rede_mais_social";
    private static final String USER = "root";
    private static final String PASSWORD = "";
```
â†’ Constantes com dados de conexÃ£o
â†’ URL = endereÃ§o do banco (localhost porta 3306, banco rede_mais_social)
â†’ USER = usuÃ¡rio root
â†’ PASSWORD = sem senha (vazio)

```java
    public static Connection getConnection() throws SQLException {
        return DriverManager.getConnection(URL, USER, PASSWORD);
    }
```
â†’ MÃ©todo estÃ¡tico (pode chamar sem criar objeto)
â†’ DriverManager.getConnection() = conecta ao MySQL
â†’ Retorna objeto Connection (representa a conexÃ£o)

RESUMO DATABASECONNECTION:
--------------------------
Centraliza configuraÃ§Ã£o do banco. Se mudar senha, muda sÃ³ aqui.

================================================================================
7. VALIDADOR.JAVA - VALIDAÃ‡Ã•ES
================================================================================

PROPÃ“SITO:
----------
Valida dados (email, CPF, CNPJ) antes de salvar no banco.

COMO FUNCIONA:
--------------

```java
public static boolean validarEmail(String email) {
    String regex = "^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$";
    return email != null && email.matches(regex);
}
```
â†’ Regex = expressÃ£o regular (padrÃ£o de texto)
â†’ Verifica se email tem formato: texto@texto.texto
â†’ Exemplo vÃ¡lido: joao@gmail.com
â†’ Exemplo invÃ¡lido: joao@gmail (falta o .com)

```java
public static boolean validarCPF(String cpf) {
    cpf = cpf.replaceAll("[^0-9]", "");
    return cpf.length() == 11;
}
```
â†’ Remove tudo que nÃ£o Ã© nÃºmero
â†’ Verifica se tem 11 dÃ­gitos
â†’ (ValidaÃ§Ã£o simplificada, nÃ£o verifica dÃ­gitos verificadores)

```java
public static boolean validarCNPJ(String cnpj) {
    cnpj = cnpj.replaceAll("[^0-9]", "");
    return cnpj.length() == 14;
}
```
â†’ Remove tudo que nÃ£o Ã© nÃºmero
â†’ Verifica se tem 14 dÃ­gitos

RESUMO VALIDADOR:
-----------------
MÃ©todos estÃ¡ticos de validaÃ§Ã£o. Evita salvar dados invÃ¡lidos no banco.

================================================================================
8. EMAILSERVICE.JAVA - ENVIO DE EMAILS
================================================================================

PROPÃ“SITO:
----------
Envia emails de confirmaÃ§Ã£o pros candidatos.

COMO FUNCIONA:
--------------

```java
public static void enviarEmailConfirmacao(String email, String nome, String token) {
    System.out.println("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
    System.out.println("ðŸ“§ EMAIL DE CONFIRMAÃ‡ÃƒO");
    System.out.println("Para: " + email);
    System.out.println("Nome: " + nome);
    System.out.println("Token: " + token);
    System.out.println("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
}
```
â†’ Por enquanto, sÃ³ imprime no console (simulaÃ§Ã£o)
â†’ Em produÃ§Ã£o, usaria SMTP pra enviar email real
â†’ Seria configurado com servidor de email (Gmail, etc)

RESUMO EMAILSERVICE:
--------------------
Simula envio de email. Facilita testar sem precisar de servidor SMTP.

================================================================================
9. FRONTEND - HTML/CSS/JAVASCRIPT
================================================================================

COMO O FRONTEND SE CONECTA COM O BACKEND:
------------------------------------------

EXEMPLO: termo-compromisso.html
--------------------------------

```javascript
// Pega dados do sessionStorage (salvos nas telas anteriores)
const dadosIdentificacao = JSON.parse(sessionStorage.getItem('dadosIdentificacao'));
const dadosPerfil = JSON.parse(sessionStorage.getItem('dadosPerfil'));
```
â†’ sessionStorage = armazenamento temporÃ¡rio do navegador
â†’ JSON.parse() = converte texto JSON em objeto JavaScript

```javascript
// Junta todos os dados em um Ãºnico objeto
const dadosCompletos = {
    ...dadosIdentificacao,
    ...dadosPerfil,
    aceiteTermo: true
};
```
â†’ Operador spread (...) = espalha todos os atributos
â†’ Cria objeto com TODOS os dados: identificaÃ§Ã£o + perfil + aceite

```javascript
// Envia pro backend
fetch('/api/solicitar-afiliacao', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(dadosCompletos)
})
```
â†’ fetch() = faz requisiÃ§Ã£o HTTP
â†’ POST = enviando dados
â†’ headers = indica que estÃ¡ enviando JSON
â†’ JSON.stringify() = converte objeto JavaScript em texto JSON

```javascript
.then(response => response.json())
.then(data => {
    if (data.sucesso) {
        // Mostra modal com token
        document.getElementById('tokenGerado').textContent = data.token;
        modal.style.display = 'block';
    }
})
```
â†’ then() = quando receber resposta
â†’ response.json() = converte resposta em objeto
â†’ Verifica se deu sucesso
â†’ Exibe token na tela

RESUMO FRONTEND:
----------------
1. Coleta dados nos formulÃ¡rios
2. Salva no sessionStorage
3. Na Ãºltima tela, junta tudo
4. Envia pro backend via fetch (AJAX)
5. Recebe resposta e exibe na tela

================================================================================
10. FLUXO COMPLETO PASSO A PASSO
================================================================================

1. USUÃRIO PREENCHE FORMULÃRIO
   â””â”€> JavaScript coleta dados e salva no sessionStorage

2. USUÃRIO CLICA "SOLICITAR AFILIAÃ‡ÃƒO"
   â””â”€> JavaScript junta todos os dados
   â””â”€> fetch() envia POST pra /api/solicitar-afiliacao

3. WEBSERVER RECEBE A REQUISIÃ‡ÃƒO
   â””â”€> SolicitarAfiliacaoHandler Ã© acionado
   â””â”€> LÃª o corpo da requisiÃ§Ã£o (JSON)
   â””â”€> Extrai cada campo do JSON
   â””â”€> Cria objeto Candidato com os dados

4. WEBSERVER CHAMA O CONTROLLER
   â””â”€> AfiliacaoController.criarCandidato(candidato)

5. CONTROLLER VALIDA OS DADOS
   â””â”€> Validador.validarEmail()
   â””â”€> Validador.validarCPF() ou validarCNPJ()
   â””â”€> Se invÃ¡lido, retorna null (erro)

6. CONTROLLER SALVA NO BANCO
   â””â”€> CandidatoDAO.inserir(candidato)
   â””â”€> DAO monta SQL INSERT
   â””â”€> DAO executa no MySQL
   â””â”€> Banco retorna ID gerado
   â””â”€> DAO coloca ID no objeto candidato

7. CONTROLLER GERA TOKEN
   â””â”€> gerarToken(email)
   â””â”€> MD5 de (email + timestamp)
   â””â”€> Retorna string de 32 caracteres

8. CONTROLLER SALVA AFILIAÃ‡ÃƒO
   â””â”€> Cria objeto Afiliacao
   â””â”€> AfiliacaoDAO.inserir(afiliacao)
   â””â”€> Salva no banco com token e status PENDENTE

9. CONTROLLER ENVIA EMAIL
   â””â”€> EmailService.enviarEmailConfirmacao()
   â””â”€> (Por enquanto sÃ³ imprime no console)

10. CONTROLLER RETORNA CANDIDATO
    â””â”€> Retorna objeto com token preenchido

11. WEBSERVER MONTA RESPOSTA JSON
    â””â”€> {"sucesso":true,"token":"abc123..."}

12. NAVEGADOR RECEBE RESPOSTA
    â””â”€> JavaScript exibe modal com token
    â””â”€> UsuÃ¡rio copia token

13. USUÃRIO COLA TOKEN NA VALIDAÃ‡ÃƒO
    â””â”€> JavaScript envia POST pra /api/validar-email

14. WEBSERVER RECEBE TOKEN
    â””â”€> ValidarEmailHandler Ã© acionado
    â””â”€> Chama Controller.validarToken()

15. CONTROLLER BUSCA NO BANCO
    â””â”€> AfiliacaoDAO.buscarPorToken()
    â””â”€> Verifica se status Ã© PENDENTE
    â””â”€> Atualiza status pra VALIDADO

16. SISTEMA RESPONDE SUCESSO
    â””â”€> Candidato estÃ¡ validado
    â””â”€> Aguarda aprovaÃ§Ã£o de representante

================================================================================
RESUMO FINAL - O QUE VOCÃŠ PRECISA SABER PARA EXPLICAR
================================================================================

1. ARQUITETURA MVC:
   - Model (Candidato, Afiliacao) = dados
   - View (HTML/CSS/JS) = interface
   - Controller (AfiliacaoController) = lÃ³gica
   - DAO = ponte com banco de dados

2. FLUXO DE DADOS:
   FormulÃ¡rio â†’ JSON â†’ WebServer â†’ Controller â†’ DAO â†’ MySQL
   MySQL â†’ DAO â†’ Controller â†’ WebServer â†’ JSON â†’ Navegador

3. VALIDAÃ‡Ã•ES:
   - Email: formato correto
   - CPF: 11 dÃ­gitos
   - CNPJ: 14 dÃ­gitos

4. TOKEN:
   - Gerado com MD5(email + timestamp)
   - 32 caracteres hexadecimais
   - Ãšnico e nÃ£o-repetÃ­vel
   - Usado pra validar email

5. BANCO DE DADOS:
   - 2 tabelas: candidato e afiliacao
   - Relacionamento 1:N (um candidato, vÃ¡rias afiliaÃ§Ãµes)
   - PreparedStatement previne SQL Injection

6. COMUNICAÃ‡ÃƒO:
   - Frontend â†’ Backend: JSON via POST
   - Backend â†’ Frontend: JSON com sucesso/erro
   - sessionStorage: armazena dados entre telas

COM ISSO VOCÃŠ CONSEGUE EXPLICAR TODO O SISTEMA! ðŸš€

================================================================================
